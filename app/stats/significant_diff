from scipy import stats
import numpy as np
from itertools import combinations

def significant_diff(model_a_scores, model_b_scores, alpha=0.01, d_thresh=0.5):
    results = {}
    for metric in ['dice', 'iou']:
        a = model_a_scores[metric]
        b = model_b_scores[metric]
        
        # Paired t-test
        t_stat, p_val = stats.ttest_rel(a, b)
        
        # Cohen's d
        diff = a - b
        d = np.mean(diff) / np.std(diff, ddof=1)
        
        results[metric] = {
            'p': p_val,
            'd': d,
            'significant': (p_val < alpha) and (abs(d) > 0.5)
        }
    
    return results







